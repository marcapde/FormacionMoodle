{"version":3,"file":"score.min.js","sources":["../src/score.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * @package\n * @author  2022 3iPunt <https://www.tresipunt.com/>\n * @license http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\n/* eslint-disable no-unused-vars */\n/* eslint-disable no-console */\n\ndefine([\n        'jquery',\n        'core/str',\n        'core/ajax',\n        'core/templates'\n    ], function ($, Str, Ajax, Templates) {\n        \"use strict\";\n\n        /**\n         *\n         */\n        let ACTION = {\n            SCORE_SELECT: '[data-action=\"score\"]',\n        };\n\n        let TEXT = {\n            COMMENT_TEXT: '[data-text=\"comment\"]',\n        };\n\n        /**\n         *\n         */\n        let SERVICES = {\n            JOKE_SCORE: 'mod_jokeofday_score'\n        };\n\n        /**\n         * @constructor\n         * @param {String} region\n         * @param {Number} jokeid\n         * @param {Number} cmid\n         */\n        function Score(region, jokeid, cmid) {\n            this.node = $(region);\n            this.node.find(ACTION.SCORE_SELECT).on('change', this.onScoreSelectChange.bind(this));\n            this.cmid = cmid;\n            this.jokeid = jokeid;\n        }\n\n        Score.prototype.onScoreSelectChange = function (e) {\n            //this.node.find(ACTION.GROUP_SELECT).val(0);\n            // TODO valores de las variables con jquery.\n\n            // GET  value.\n            let val = document.getElementById(\"selectvalue\");\n            val = val.options[val.selectedIndex].value;\n            var request = {\n                methodname: SERVICES.JOKE_SCORE,\n                args: {\n                    jokeid: this.jokeid,\n                    cmid: this.cmid,\n                    value: val,\n                }\n            };\n            console.log(request);\n            Ajax.call([request])[0].done(function(response) {\n                // TODO ahora que? recargar pagina.\n                console.log(response);\n                //location.reload();\n            }).fail((error) => { console.log(error);});\n        };\n    // Notification.exception\n        /** @type {jQuery} The jQuery node for the region. */\n        Score.prototype.node = null;\n\n        return {\n            /**\n             * @param {String} region\n             * @param {Number} jokeid\n             * @param {Number} cmid\n             * @return {Score}\n             */\n            initScore: function (region, jokeid, cmid) {\n                return new Score(region, jokeid, cmid);\n            }\n        };\n    }\n);\n"],"names":["define","$","Str","Ajax","Templates","ACTION","SERVICES","Score","region","jokeid","cmid","node","find","on","this","onScoreSelectChange","bind","prototype","e","val","document","getElementById","options","selectedIndex","value","request","methodname","args","console","log","call","done","response","fail","error","initScore"],"mappings":";;;;;AAwBAA,6BAAO,CACC,SACA,WACA,YACA,mBACD,SAAUC,EAAGC,IAAKC,KAAMC,eAMnBC,oBACc,wBAUdC,oBACY,+BASPC,MAAMC,OAAQC,OAAQC,WACtBC,KAAOV,EAAEO,aACTG,KAAKC,KAAKP,qBAAqBQ,GAAG,SAAUC,KAAKC,oBAAoBC,KAAKF,YAC1EJ,KAAOA,UACPD,OAASA,cAGlBF,MAAMU,UAAUF,oBAAsB,SAAUG,OAKxCC,IAAMC,SAASC,eAAe,eAClCF,IAAMA,IAAIG,QAAQH,IAAII,eAAeC,UACjCC,QAAU,CACVC,WAAYpB,oBACZqB,KAAM,CACFlB,OAAQK,KAAKL,OACbC,KAAMI,KAAKJ,KACXc,MAAOL,MAGfS,QAAQC,IAAIJ,SACZtB,KAAK2B,KAAK,CAACL,UAAU,GAAGM,MAAK,SAASC,UAElCJ,QAAQC,IAAIG,aAEbC,MAAMC,QAAYN,QAAQC,IAAIK,WAIrC3B,MAAMU,UAAUN,KAAO,KAEhB,CAOHwB,UAAW,SAAU3B,OAAQC,OAAQC,aAC1B,IAAIH,MAAMC,OAAQC,OAAQC"}